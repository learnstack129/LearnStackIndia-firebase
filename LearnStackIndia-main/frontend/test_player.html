<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LearnStackIndia - Secure Test</title>
    <script>
      (function() {
        const savedTheme = localStorage.getItem('theme') || 'light'; 
        if (savedTheme === 'dark') {
          document.documentElement.classList.add('dark');
        } else {
          document.documentElement.classList.remove('dark');
        }
      })();
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: { extend: {} }
        };
    </script>
    <style>
              /* frontend/test_player.css */
        body {
            font-family: 'Inter', sans-serif;
        }
        
        .container {
            max-width: 900px;
            margin: 2rem auto;
            padding: 2rem;
            background-color: var(--bg-secondary-light);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-lg);
        }
        
        :root {
          --bg-primary-light: #f8fafc;
          --bg-secondary-light: #ffffff;
          --bg-tertiary-light: #f1f5f9;
          --border-color: #e2e8f0;
          --text-primary-light: #1e293b;
          --text-secondary-light: #475569;
          --accent-primary: #3b82f6;
          --accent-hover: #2563eb;
          --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
          --border-radius-lg: 0.5rem;
        }
        
        .dark{
          --bg-primary-light: #0f172a;
          --bg-secondary-light: #1e293b;
          --bg-tertiary-light: #334155;
          --border-color: #475569;
          --text-primary-light: #f1f5f9;
          --text-secondary-light: #cbd5e1;
        }
        
        body {
            background-color: var(--bg-primary-light);
            color: var(--text-primary-light);
        }
        
        .container {
            background-color: var(--bg-secondary-light);
            border-color: var(--border-color);
            box-shadow: var(--shadow-lg);
            border-radius: var(--border-radius-lg);
        }
        
        .test-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        .timer-box {
            background-color: var(--bg-tertiary-light);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-lg);
            padding: 0.5rem 1rem;
            text-align: center;
        }
        .timer-label {
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-secondary-light);
            text-transform: uppercase;
        }
        .timer-time {
            font-size: 1.875rem;
            font-weight: 700;
            color: var(--accent-primary);
            line-height: 1;
        }
        .question-box {
            padding: 1.5rem 0;
        }
        .question-text {
            font-size: 1.25rem;
            font-weight: 600;
            line-height: 1.7;
        }
        
        /* Answer Styles */
        .answer-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        .answer-option {
            display: flex;
            align-items: center;
            padding: 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-lg);
            background-color: var(--bg-primary-light);
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }
        .answer-option:hover {
            border-color: var(--accent-primary);
            background-color: var(--bg-tertiary-light);
        }
        .answer-option.selected {
            border-color: var(--accent-primary);
            background-color: var(--accent-light);
            box-shadow: 0 0 0 2px var(--accent-primary);
            color: var(--accent-hover);
        }
        [data-theme="dark"] .answer-option.selected {
            background-color: #2b3a63;
            color: #a7c5f4;
        }
        .answer-short {
            margin-top: 1rem;
        }
        
        /* Footer */
        .test-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-color);
            margin-top: 1.5rem;
        }
        .strike-box {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        .strike-dot {
            width: 1.25rem;
            height: 1.25rem;
            border-radius: 9999px;
            background-color: #e5e7eb;
            border: 2px solid #d1d5db;
            transition: all 0.3s ease;
        }
        [data-theme="dark"] .strike-dot {
            background-color: #4b5563;
            border-color: #6b7280;
        }
        .strike-dot.active {
            background-color: #fef2f2;
            border-color: #ef4444;
            box-shadow: 0 0 8px rgba(239, 68, 68, 0.5);
        }
        [data-theme="dark"] .strike-dot.active {
            background-color: #5c2c2c;
            border-color: #ef4444;
        }
        
        /* Modal Styles */
        .modal-backdrop {
            position: fixed;
            inset: 0;
            z-index: 50;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            animation: fadeIn 0.3s ease;
        }
        .modal-box {
            background-color: var(--bg-secondary-light);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-lg);
            width: 100%;
            max-width: 450px;
            padding: 2rem;
            text-align: center;
            animation: slideUp 0.3s ease;
        }
        .modal-actions {
            margin-top: 1.5rem;
        }
        
        /* Spinner */
        .spinner {
            width: 48px;
            height: 48px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        [data-theme="dark"] .spinner {
            border-color: var(--bg-tertiary-light);
            border-top-color: var(--accent-primary);
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Utility Classes */
        .hidden { display: none; }
        .input-field {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 0.375rem;
            background-color: var(--bg-primary-light);
            transition: all 0.2s ease;
        }
        .input-field:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 2px var(--accent-primary);
        }
        .btn-primary {
            padding: 0.75rem 1.5rem;
            background-color: var(--accent-primary);
            color: white;
            font-weight: 500;
            border-radius: 0.375rem;
            box-shadow: var(--shadow-lg);
            transition: background-color 0.2s;
        }
        .btn-primary:hover { background-color: var(--accent-hover); }
        .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-secondary {
            padding: 0.75rem 1.5rem;
            background-color: var(--bg-tertiary-light);
            color: var(--text-primary-light);
            border: 1px solid var(--border-color);
            font-weight: 500;
            border-radius: 0.375rem;
            transition: background-color 0.2s;
        }
        [data-theme="dark"] .btn-secondary { background-color: var(--bg-tertiary-light); }
        .btn-secondary:hover { background-color: var(--border-color); }
        [data-theme="dark"] .btn-secondary:hover { background-color: #4b5563; }
        
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100">

    <main id="test-ui" class="container hidden">
        <header class="test-header">
            <div>
                <h1 id="testTitle" class="text-2xl font-bold">Loading Test...</h1>
                <p id="questionCounter" class="text-sm text-gray-600 dark:text-gray-400">Question 1 / 10</p>
            </div>
            <div class="timer-box">
                <div class="timer-label">Time Left</div>
                <div id="questionTimer" class="timer-time">00:00</div>
            </div>
        </header>

        <section class="question-box">
            <h2 id="questionText" class="question-text">Loading question text...</h2>
        </section>

        <section id="answer-area">
            <div id="mcqOptions" class="answer-grid">
                </div>
            
            <div id="shortAnswerBox" class="answer-short hidden">
                <label for="shortAnswerInput" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Your Answer:</label>
                <input type="text" id="shortAnswerInput" class="input-field" placeholder="Type your answer here...">
            </div>
        </section>

        <footer class="test-footer">
            <div class="strike-box">
                <span class="text-sm font-medium">Violations:</span>
                <div class="flex space-x-2">
                    <span id="strike1" class="strike-dot"></span>
                    <span id="strike2" class="strike-dot"></span>
                    <span id="strike3" class="strike-dot"></span>
                </div>
            </div>
            <button id="submitAnswerBtn" class="btn-primary">
                <span>Submit Answer</span>
                <i class="fas fa-arrow-right ml-2"></i>
            </button>
        </footer>
    </main>
    
    <div id="pageLoader" class="modal-backdrop">
        <div class="spinner"></div>
    </div>

    <div id="passwordModal" class="modal-backdrop hidden">
        <div class="modal-box">
            <h2 class="text-xl font-bold mb-4">Enter Test Password</h2>
            <p id="passwordTestTitle" class="text-gray-600 dark:text-gray-400 mb-4">Please enter the password to begin the test.</p>
            <input type="password" id="testPasswordInput" class="input-field" placeholder="Test Password...">
            <p id="passwordError" class="text-red-500 text-sm h-4 mt-2"></p>
            <div class="modal-actions">
                <button id="startTestBtn" class="btn-primary w-full">Start Test</button>
            </div>
        </div>
    </div>

    <div id="warningModal" class="modal-backdrop hidden">
        <div class="modal-box">
            <i class="fas fa-exclamation-triangle text-5xl text-yellow-500 mb-4"></i>
            <h2 class="text-2xl font-bold mb-2">Violation Detected!</h2>
            <p id="warningStrikeText" class="text-lg mb-4">You have left fullscreen or switched tabs.</p>
            <p class="text-gray-600 dark:text-gray-400 mb-6">This is warning <span id="strikeCount">1</span> of 3.</p>
            <button id="resumeTestBtn" class="btn-primary w-full">Re-enter Fullscreen to Continue</button>
        </div>
    </div>

    <div id="lockedModal" class="modal-backdrop hidden">
        <div class="modal-box">
            <i class="fas fa-lock text-5xl text-red-500 mb-4"></i>
            <h2 class="text-2xl font-bold mb-2">Test Locked</h2>
            <p class="text-lg mb-4">You have exceeded the 3-strike limit for violations.</p>
            <p class="text-gray-600 dark:text-gray-400 mb-6">Your test is now locked. Please contact your mentor to request an unlock.</p>
            <a href="dashboard.html" class="btn-secondary w-full">Return to Dashboard</a>
        </div>
    </div>
    
    <div id="completeModal" class="modal-backdrop hidden">
        <div class="modal-box">
            <i class="fas fa-check-circle text-5xl text-green-500 mb-4"></i>
            <h2 class="text-2xl font-bold mb-2">Test Complete!</h2>
            <p class="text-lg mb-4">You have successfully completed the test.</p>
            <p class="text-gray-600 dark:text-gray-400 mb-6">Your final score is: <span id="finalScore" class="font-bold text-xl">0</span></p>
            <a href="dashboard.html" class="btn-primary w-full">Return to Dashboard</a>
        </div>
    </div>

    <script>
        // frontend/test_player.js
        
        // --- Globals ---
        const API_BASE_URL = '/api';
        let currentTestId = null;
        let currentAttemptId = null;
        let currentQuestion = null;
        let currentStrikes = 0;
        let questionTimerInterval = null;
        let timeLeft = 0;
        let isPaused = false;
        let isSubmitting = false;
        let questionNumber = 0;
        let totalQuestions = 0;
        let hasUnloggedViolation = false; // *** NEW *** Flag to track if a violation needs to be logged
        
        // --- DOM Elements ---
        const pageLoader = document.getElementById('pageLoader');
        const testUI = document.getElementById('test-ui');
        const passwordModal = document.getElementById('passwordModal');
        const warningModal = document.getElementById('warningModal');
        const lockedModal = document.getElementById('lockedModal');
        const completeModal = document.getElementById('completeModal');
        const testPasswordInput = document.getElementById('testPasswordInput');
        const startTestBtn = document.getElementById('startTestBtn');
        const passwordError = document.getElementById('passwordError');
        const passwordTestTitle = document.getElementById('passwordTestTitle');
        const testTitle = document.getElementById('testTitle');
        const questionCounter = document.getElementById('questionCounter');
        const questionTimer = document.getElementById('questionTimer');
        const questionText = document.getElementById('questionText');
        const mcqOptions = document.getElementById('mcqOptions');
        const shortAnswerBox = document.getElementById('shortAnswerBox');
        const shortAnswerInput = document.getElementById('shortAnswerInput');
        const submitAnswerBtn = document.getElementById('submitAnswerBtn');
        const resumeTestBtn = document.getElementById('resumeTestBtn');
        
        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            if (!getAuthToken()) {
                redirectToLogin();
                return;
            }
            
            const params = new URLSearchParams(window.location.search);
            currentTestId = params.get('testId');
            if (!currentTestId) {
                alert('Test ID not found. Redirecting to dashboard.');
                window.location.href = 'dashboard.html';
                return;
            }
        
            showModal('passwordModal');
            pageLoader.classList.add('hidden');
            
            startTestBtn.addEventListener('click', handleTestStart);
            submitAnswerBtn.addEventListener('click', handleSubmitAnswer);
            
            // *** MODIFIED LISTENER ***
            resumeTestBtn.addEventListener('click', handleResumeAttempt); // Changed from requestProctoring
            
            // Add proctoring listeners (they will be activated after test starts)
            document.addEventListener('visibilitychange', handleVisibilityChange);
            document.addEventListener('fullscreenchange', handleFullscreenChange);
        });
        
        // --- Authentication ---
        function getAuthToken() {
            return localStorage.getItem('authToken');
        }
        
        function redirectToLogin() {
            localStorage.removeItem('authToken');
            localStorage.removeItem('currentUser');
            window.location.href = 'auth.html';
        }
        
        // --- API Calls ---
        async function makeTestAPICall(endpoint, options = {}) {
            const token = getAuthToken();
            if (!token) {
                redirectToLogin();
                return null;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/test${endpoint}`, {
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`,
                        ...options.headers
                    },
                    ...options
                });
                
                const data = await response.json();
                
                if (response.status === 401) {
                    redirectToLogin();
                    return null;
                }
                
                if (!response.ok) {
                    throw new Error(data.message || `HTTP Error ${response.status}`);
                }
                
                return data;
            } catch (error) {
                console.error(`API Error (${endpoint}):`, error);
                alert(`Error: ${error.message}`);
                return null;
            }
        }
        
        // --- Test Flow ---
        async function handleTestStart() {
            const password = testPasswordInput.value;
            if (!password) {
                passwordError.textContent = 'Password is required.';
                return;
            }
            
            startTestBtn.disabled = true;
            startTestBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Starting...';
            passwordError.textContent = '';
            
            const data = await makeTestAPICall(`/start/${currentTestId}`, {
                method: 'POST',
                body: JSON.stringify({ password })
            });
            
            if (data && data.success) {
                currentAttemptId = data.attemptId;
                currentStrikes = data.strikes;
                testTitle.textContent = data.testTitle;
                totalQuestions = data.totalQuestions || 0; 
                updateStrikeUI();
                
                hideModal('passwordModal');
                
                // *** MODIFIED ***
                // Request fullscreen *before* showing the test
                requestFullscreenAndResume(); // Use new function name
                
                testUI.classList.remove('hidden');
                loadQuestion(data.currentQuestion); 

            } else if (data && data.status === 'locked') {
                hideModal('passwordModal');
                showModal('lockedModal');
            } else {
                passwordError.textContent = data ? data.message : 'An unknown error occurred.';
                startTestBtn.disabled = false;
                startTestBtn.innerHTML = 'Start Test';
            }
        }

        function loadQuestion(question) {
            if (!question) {
                stopQuestionTimer();
                showModal('completeModal');
                return;
            }
            
            currentQuestion = question;
            questionNumber += 1;
            
            questionText.textContent = currentQuestion.text;
            questionCounter.textContent = `Question ${questionNumber} / ${totalQuestions}`; 
            
            if (currentQuestion.questionType === 'mcq') {
                mcqOptions.innerHTML = '';
                mcqOptions.classList.remove('hidden');
                shortAnswerBox.classList.add('hidden');
                
                currentQuestion.options.forEach((option, index) => {
                    const button = document.createElement('button');
                    button.className = 'answer-option';
                    button.dataset.index = index;
                    button.textContent = option;
                    button.onclick = () => selectOption(button);
                    mcqOptions.appendChild(button);
                });
                
            } else if (currentQuestion.questionType === 'short_answer') {
                mcqOptions.classList.add('hidden');
                shortAnswerBox.classList.remove('hidden');
                shortAnswerInput.value = '';
            }
            
            startQuestionTimer(currentQuestion.timeLimit);
            isSubmitting = false;
            submitAnswerBtn.disabled = false;
            submitAnswerBtn.innerHTML = '<span>Submit Answer</span><i class="fas fa-arrow-right ml-2"></i>';
        }
        
        function selectOption(selectedButton) {
            document.querySelectorAll('.answer-option').forEach(btn => {
                btn.classList.remove('selected');
            });
            selectedButton.classList.add('selected');
        }
        
        async function handleSubmitAnswer() {
            if (isSubmitting) return;
            isSubmitting = true;
            submitAnswerBtn.disabled = true;
            submitAnswerBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Submitting...';
            stopQuestionTimer();
        
            let answer = null;
            
            if (currentQuestion.questionType === 'mcq') {
                const selected = document.querySelector('.answer-option.selected');
                if (selected) {
                    answer = selected.dataset.index;
                }
            } else if (currentQuestion.questionType === 'short_answer') {
                answer = shortAnswerInput.value;
            }
            
            if (answer === null && timeLeft <= 0) {
                console.log("Time's up! Submitting null.");
            } else if (answer === null) {
                alert('Please select or type an answer.');
                isSubmitting = false;
                submitAnswerBtn.disabled = false;
                submitAnswerBtn.innerHTML = '<span>Submit Answer</span><i class="fas fa-arrow-right ml-2"></i>';
                startQuestionTimer(timeLeft); 
                return;
            }
            
            const data = await makeTestAPICall('/submit', {
                method: 'POST',
                body: JSON.stringify({
                    attemptId: currentAttemptId,
                    questionId: currentQuestion._id,
                    answer: answer
                })
            });
            
            if (data) {
                if (data.testComplete) {
                    hideModal('test-ui');
                    showModal('completeModal');
                    document.getElementById('finalScore').textContent = data.finalScore;
                } else {
                    loadQuestion(data.nextQuestion);
                }
            } else {
                isSubmitting = false;
                submitAnswerBtn.disabled = false;
                submitAnswerBtn.innerHTML = '<span>Submit Answer</span><i class="fas fa-arrow-right ml-2"></i>';
                startQuestionTimer(timeLeft); 
            }
        }
        
        // --- Timer Logic ---
        function startQuestionTimer(seconds) {
            stopQuestionTimer();
            if (seconds > 0) timeLeft = seconds; // Don't reset to 0 if resuming
            isPaused = false;
            updateTimerDisplay();
            
            questionTimerInterval = setInterval(() => {
                if (!isPaused) {
                    timeLeft--;
                    updateTimerDisplay();
                    
                    if (timeLeft <= 0) {
                        stopQuestionTimer();
                        handleTimeUp();
                    }
                }
            }, 1000);
        }
        
        function stopQuestionTimer() {
            if (questionTimerInterval) {
                clearInterval(questionTimerInterval);
                questionTimerInterval = null;
            }
        }
        
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            questionTimer.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }
        
        function handleTimeUp() {
            console.log("Time's up for this question!");
            handleSubmitAnswer(); 
        }
        
        // --- Proctoring & Violation Logic ---

        // *** START: MODIFIED PROCTORING LOGIC ***

        function handleVisibilityChange() {
            if (document.hidden && !isPaused) { 
                console.log("VIOLATION: Tab switched");
                pauseForViolation(); 
            }
        }
        
        function handleFullscreenChange() {
            if (!document.fullscreenElement && !isPaused) { 
                console.log("VIOLATION: Fullscreen exited");
                pauseForViolation(); 
            }
        }
        
        function pauseForViolation() {
            if (isPaused) return; // Violation already triggered
            isPaused = true;
            hasUnloggedViolation = true; // Mark that we need to log this
            stopQuestionTimer(); 

            // Optimistically update the UI to show the *next* strike
            const nextStrike = currentStrikes + 1;
            updateStrikeUI(nextStrike); 
            
            if (nextStrike >= 3) {
                document.getElementById('strikeCount').textContent = '3';
                document.getElementById('warningStrikeText').textContent = '3-strike limit reached. Test will be locked upon resuming.';
            } else {
                document.getElementById('strikeCount').textContent = nextStrike;
                document.getElementById('warningStrikeText').textContent = `You have left fullscreen or switched tabs.`;
            }
            showModal('warningModal');
        }

        async function handleResumeAttempt() {
            let isNowLocked = false;
            
            // 1. Log the violation if one happened
            if (hasUnloggedViolation) {
                isNowLocked = await logViolationAPI(); 
                hasUnloggedViolation = false; // Mark as logged
            }

            // 2. If the API call resulted in a lock, stop here
            if (isNowLocked) {
                return; 
            }
            
            // 3. If not locked, request fullscreen and resume
            requestFullscreenAndResume();
        }

        async function logViolationAPI() {
            // This function now *only* calls the API and returns if the user is locked
            const data = await makeTestAPICall('/violation', {
                method: 'POST',
                body: JSON.stringify({ attemptId: currentAttemptId })
            });
            
            if (!data) {
                alert("Error logging violation. Please try resuming again.");
                hasUnloggedViolation = true; // Mark for retry
                return false; // Not locked (API failed)
            }
        
            currentStrikes = data.strikes;
            updateStrikeUI(); // Update with the *confirmed* strike count
        
            if (data.status === 'locked') {
                stopQuestionTimer();
                hideModal('warningModal');
                showModal('lockedModal');
                if(document.fullscreenElement) document.exitFullscreen();
                document.removeEventListener('visibilitychange', handleVisibilityChange);
                document.removeEventListener('fullscreenchange', handleFullscreenChange);
                isPaused = true; // Keep test paused (locked)
                return true; // Return true = is locked
            }

            // Not locked
            return false; // Return false = not locked
        }
        
        function requestFullscreenAndResume() {
            // This function now also resumes the timer
            const resumeTest = () => {
                hideModal('warningModal');
                isPaused = false;
                startQuestionTimer(timeLeft); // <-- RESUME TIMER
            };

            if (document.fullscreenElement) {
                resumeTest();
            } else {
                document.documentElement.requestFullscreen()
                    .then(resumeTest)
                    .catch(err => {
                        console.error("Fullscreen request failed:", err);
                        // User *must* be in fullscreen. Keep modal open.
                        isPaused = true; // Keep test paused
                    });
            }
        }
        
        function updateStrikeUI(optimisticStrikes = -1) {
            // Use the optimistic count if provided, otherwise use the confirmed count
            const strikesToDisplay = optimisticStrikes !== -1 ? optimisticStrikes : currentStrikes;
            
            for (let i = 1; i <= 3; i++) {
                const strikeDot = document.getElementById(`strike${i}`);
                if (i <= strikesToDisplay) {
                    strikeDot.classList.add('active');
                } else {
                    strikeDot.classList.remove('active');
                }
            }
        }
        // *** END: MODIFIED PROCTORING LOGIC ***
        
        // --- Modal Utilities ---
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) modal.classList.remove('hidden');
        }
        
        function hideModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) modal.classList.add('hidden');
        }
    </script>
</body>
</html>
